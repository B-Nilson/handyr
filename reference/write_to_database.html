<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write data to a database — write_to_database • handyr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write data to a database — write_to_database"><meta name="description" content="Write data to a database, with options to insert new data, update existing data, and create a new table."><meta property="og:description" content="Write data to a database, with options to insert new data, update existing data, and create a new table."><meta property="og:image" content="https://b-nilson.github.io/handyr/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">handyr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/B-Nilson/handyr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Write data to a database</h1>
      <small class="dont-index">Source: <a href="https://github.com/B-Nilson/handyr/blob/main/R/write_to_database.R" class="external-link"><code>R/write_to_database.R</code></a></small>
      <div class="d-none name"><code>write_to_database.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Write data to a database, with options to insert new data, update existing data, and create a new table.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_to_database</span><span class="op">(</span></span>
<span>  <span class="va">db</span>,</span>
<span>  <span class="va">table_name</span>,</span>
<span>  <span class="va">new_data</span>,</span>
<span>  <span class="va">primary_keys</span>,</span>
<span>  unique_indexes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indexes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  insert_new <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  update_duplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_on_conflict <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skip_checks <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-db">db<a class="anchor" aria-label="anchor" href="#arg-db"></a></dt>
<dd><p>A database connection or path to database (if sqlite or duckdb file extension).</p></dd>


<dt id="arg-table-name">table_name<a class="anchor" aria-label="anchor" href="#arg-table-name"></a></dt>
<dd><p>A character string specifying the table to write to.</p></dd>


<dt id="arg-new-data">new_data<a class="anchor" aria-label="anchor" href="#arg-new-data"></a></dt>
<dd><p>A data frame to write to the table.</p></dd>


<dt id="arg-primary-keys">primary_keys<a class="anchor" aria-label="anchor" href="#arg-primary-keys"></a></dt>
<dd><p>A character vector of column names to use as the primary key, the main identifier of individual rows in a table.
Multiple columns can be specified and uniqueness will be assessed based on the combination of columns.
(e.g. <code>primary_keys = c("col1", "col2")</code> will add a primary key on the combination of <code>col1</code> and <code>col2</code>).
Primary keys are functionally similiar to "unique indexes", but act as the main row identifier.</p></dd>


<dt id="arg-unique-indexes">unique_indexes<a class="anchor" aria-label="anchor" href="#arg-unique-indexes"></a></dt>
<dd><p>A list of character vector(s) of column names to use as unique indexes.
These will be added to the table, in addition to the primary key, and will result in an error if non-unique data is inserted/existing.
Indexes speed up queries by allowing for faster lookups, but can increase the size of the database and reduce write performance.
Multiple columns can be specified and uniqueness will be assessed based on the combination of columns.
(e.g. <code>unique_indexes = list(c("col1", "col2"))</code> will add a unique index on the combination of <code>col1</code> and <code>col2</code>.).
If <code>NULL</code> (the default), no unique indexes will be added.</p></dd>


<dt id="arg-indexes">indexes<a class="anchor" aria-label="anchor" href="#arg-indexes"></a></dt>
<dd><p>A list of character vector(s) of column names to use as indexes.
These will be added to the table, in addition to the primary key and unique indexes.
Indexes speed up queries by allowing for faster lookups, but can increase the size of the database and reduce write performance.
Multiple columns can be specified for composite indexes, and the index will be named after the list names if provided.
If <code>NULL</code> (the default), no indexes will be added.</p></dd>


<dt id="arg-insert-new">insert_new<a class="anchor" aria-label="anchor" href="#arg-insert-new"></a></dt>
<dd><p>A logical value indicating if new data should be inserted into the existing table.
If <code>FALSE</code>, no new data will be inserted, only existing rows will be updated if <code>update_duplicates = TRUE</code>.
Ignored if <code>skip_checks</code> is <code>TRUE</code>.
Default is <code>TRUE</code>.</p></dd>


<dt id="arg-update-duplicates">update_duplicates<a class="anchor" aria-label="anchor" href="#arg-update-duplicates"></a></dt>
<dd><p>A logical value indicating if existing rows should be updated with new data.
If <code>FALSE</code>, no existing rows will be updated. Only new data will be inserted if <code>insert_new = TRUE</code>.
Ignored if <code>skip_checks</code> is <code>TRUE</code>.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-use-on-conflict">use_on_conflict<a class="anchor" aria-label="anchor" href="#arg-use-on-conflict"></a></dt>
<dd><p>A logical value indicating if the <code>ON CONFLICT</code> clause should be used when updating existing rows.
This will be faster for bulk inserts, but requires a unique contraint on the provided <code>primary_keys</code>,
and <code>db</code> must support <code>ON CONFLICT</code> (e.g. SQLite, Postgres).
If <code>FALSE</code>, the <code>ON CONFLICT</code> clause will not be used.</p></dd>


<dt id="arg-skip-checks">skip_checks<a class="anchor" aria-label="anchor" href="#arg-skip-checks"></a></dt>
<dd><p>A logical value indicating if checks for overlapping data should be skipped.
If <code>TRUE</code>, <code><a href="https://dbi.r-dbi.org/reference/dbAppendTable.html" class="external-link">DBI::dbAppendTable()</a></code> will be used to insert new data, and will fail if there are overlapping primary keys.
Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An invisible db connection.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It will create the table and insert <code>new_data</code> if the table does not already exist.
Otherwise:</p><ul><li><p>If <code>insert_new = TRUE</code>, <code>new_data</code> will be inserted into the existing table.</p></li>
<li><p>If <code>update_duplicates = TRUE</code>, existing data will be updated with the overlap of <code>new_data</code>.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brayden Nilson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

